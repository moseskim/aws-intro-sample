version: 0.2

phases:
  install:
    runtime-versions:
      ruby: 2.7
  pre_build:
    commands:
      - yum -y install yum-utils
      - echo Installing mysql server 5.6...
      - yum localinstall https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm -y
      - yum-config-manager --disable mysql80-community
      - yum-config-manager --enable mysql57-community
      - yum info mysql-community-server
      - yum install mysql-community-server -y
      - mysqld --version
      - systemctl start mysqld.service
      - systemctl enable mysqld.service
      - systemctl status mysqld.service
      - echo Installing ruby on rails...
      - gem update --system
      - gem install bundler
      - bundle install
  build:
    commands:
      - rails test
